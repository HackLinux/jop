
\input{preamble}

\input{classes/jdoc_preamble}


\begin{document}

\title{JOP User Manual}
\author{Martin Schoeberl\\martin@jopdesign.com}
\maketitle \thispagestyle{empty}

%\input{intro/title}


%\input{intro/abstract}

\pagestyle{scrheadings} \pagenumbering{roman}

\tableofcontents \cleardoublepage
 \listoftables \newpage \listoffigures
 \newpage \lstlistoflistings \newpage

\chapter*{Foreword}

This book is about JOP, the Java Optimized Processor. JOP began as
research project for a PhD thesis. JOP has been used in several
industrial applications and, due to the fact that it is an
open-source project, has a growing user base. This book is written
for all of you who build this lively community. The book is based to
some extent on the PhD thesis. For a long time the thesis, some
research papers, and the web site  have been the only available
documentation for JOP. A thesis is quite different to a user manual.
Its focus is on research results and implementation details are
usually omitted. This book fills the gap and provides inside into
the implementation of JOP and the accompanying Java virtual machine
(JVM). It also gives you an idea how to build an embedded real-time
system based on JOP.


\pagestyle{scrheadings} \pagenumbering{arabic}


%-----------------------------------------------------------------
% here we start to work
%-----------------------------------------------------------------

\chapter{Introduction}
\label{chap:intro}

\emph{Copy some stuff from the thesis and rewrite it.}
    \input{intro/intro}

\section{Is JOP the Solution for Your Problem?}

\emph{TODO: move is to the correct place.}

I had a lot of fun, and still have, developing and using JOP, but
should you use JOP? JOP is a processor design intended as a time
predictable solution for hard real-time systems. If your application
or research focus is on those systems and you prefer Java as
programming language JOP is the right choice. If you are interested
in larger, dynamic systems JOP is the wrong choice. If average
performance is important for you and you do not care about
worst-case performance other solutions will probably do a better
job.


\input{intro/directory}


\chapter{Introduction into the Design Flow}
\label{chap:build}
\input{build/flow}

\chapter{Java and the Java Virtual Machine}
\label{chap:java}
\input{intro/java}

\chapter{Restrictions of Java for Embedded Real-Time Systems}
\emph{Shall we keep this one? Or better SCJ/RtThread description
(with some of general Java ME related stuff -- shorter.}

\label{chap:rtjava}
    \input{restrictions/restrictions}

\chapter{JOP Architecture}
\label{chap:arch}

    \input{arch/arch_intro}
    \input{arch/jvm_bench}
%\clearpage or pagebreak[x]
    \input{arch/arch_jop}

\clearpage
    \section{An Efficient Stack Machine}
    \label{sec:stack}
    \input{stack/stack}

\clearpage
    \input{arch/hwsw_codesign}
\clearpage
    \input{arch/rt_predict}

\clearpage
    \section{A Time-Predictable Instruction Cache}
    \label{sec:cache}
    \input{cache/cache}

\chapter{JOP Runtime System}
\label{chap:runtime}

    \input{runtime/rt_intro}
    \input{runtime/rt_profile}
    \input{runtime/rt_user}
    \input{jvm/jvm}
    \input{jvm/boot}
    \label{sec:gc}
    \input{jvm/gc}

\chapter{The SimpCon Interconnect}
\label{chap:simpcon}
\newcommand{\scgrsc}{.65}
\newcommand{\scgrp}{simpcon}
\hyphenation{SimpCon}
\input{simpcon/simpcon_intro}
\input{simpcon/simpcon_text}

\chapter{The Embedded Java TCP/IP Stack}
\label{chap:ejip}
\newcommand{\grpath}{ejip}
\input{ejip/ejip}

\chapter{Ongoing Work}
\label{chap:ongoing}
    \input{ongoing/interrupt}

\chapter{Results}
\emph{Copy some stuff from the thesis (and JSA). Change this chapter
to new form... Update with actual numbers!}

\label{chap:results}
    \input{results/results}

\chapter{Related Work}
\label{chap:related}

\emph{Update with JSA writing and remove old, not used stuff (or
shorten it)}
    \input{related/related}


\chapter{Notes - to be moved}

\section{Testing JOP}

\input{test/test}

\section{Dependencies}

\subsection{Changing the Class Format}

\begin{itemize}
    \item JOPizer: CLS\_HEAD, dump()
    \item GC.java uses CLASS\_HEADR
    \item JMV.java uses CLASS\_HEADR + offset (checkcast, instanceof)
\end{itemize}

\subsection{Stack Size}

\begin{itemize}
    \item \code{ram\_width} in \code{jop\_config\_xx.vhd}
    \item \code{STACK\_SIZE} in \code{com.jopdesign.sys.Const}
    \item \code{RAM\_LEN} in \code{com.jopdesign.sys.Jopa}
\end{itemize}

\chapter{Summary}
\label{chap:conclusions}

    \input{outro/outro}


%\printindex
%\pagestyle{empty}
%\chaptermark{} % remove chapter mark in the heading, but it does it on the
               % last page too!
\bibliographystyle{plain}
%\bibliographystyle{plnnolow} % changed plain.bst to keep upper case in titles
\bibliography{../bib/all}



%\def\rightmark{} % remove section part in the heading
\appendix
 \ihead{\leftmark} % use chapter (=\leftmark) on both pages in the appendix

\chapter{Publications}
    \input{outro/publications}

%\chapter{Glossary}
\chapter{Acronyms}
 \label{appx:acro}
\input{appendix/acronyms}


\chapter{JOP Instruction Set} \label{appx:jop:instr}
\input{appendix/instruction_set}

\chapter{Bytecode Execution Time} \label{appx:bytecode}
\input{appendix/bytetable}

\chapter{Benchmark Results} \label{appx:bench}
\input{appendix/benchmarks}

\chapter{Cyclone FPGA Board} \label{appx:cycore}
\input{appendix/cycore}

\input{classes/classes}

% uncomment for IKT book ;-)
%\chapter{TODO Lists}
%\input{appendix/todo}


\end{document}
